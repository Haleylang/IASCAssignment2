define("date-picker",function(require){var minDate=new Date;minDate.setDate(minDate.getDate()-1);var $=require("jquery"),datePickerJs=require("datepickerjs"),defaults={inline:true,ranged:false,min:minDate,display:1,yearsForward:2,yearsPast:0,maxDays:0,dark:false};var create=function(element,options){var self={datePicker:null,element:element,options:$.extend({},defaults,options),i18Nlang:null,config:null,init:function(){self._createPicker();self._bindEvents();return self},_bindEvents:function(){var that=self;$(self.element).parent().on("keydown","button",function(e){that.onButtonKeyDown(that,e)});$(self.element).parent().on("keydown","select",function(e){that.onSelectKeyDown(that,e)});$(self.element).parent().on("change","select",function(e){that.onSelectChange(that,e)});this._onRender=this._onRender.bind(this)},_getDateArray:function(start,end){var arr=new Array,dt=new Date(start);while(dt<=end){arr.push(new Date(dt));dt.setDate(dt.getDate()+1)}return arr},get:function(){return self.datePicker},getDate:function(){var selectedDates=self.datePicker.getDate();if(Array.isArray(selectedDates)){var startDate=selectedDates[0];var endDate=selectedDates[selectedDates.length-1];return{startDate:startDate,endDate:endDate,startDateDisplay:self.getDisplayDate(startDate),startDateDisplayFull:self.getDisplayDateFull(startDate),endDateDisplay:self.getDisplayDate(endDate),endDateDisplayFull:self.getDisplayDateFull(endDate),dateArray:selectedDates}}else{return{startDate:selectedDates,endDate:null,startDateDisplay:self.getDisplayDate(selectedDates),startDateDisplayFull:self.getDisplayDateFull(selectedDates),endDateDisplay:null,endDateDisplayFull:null,dateArray:selectedDates}}},setDate:function(date){var goTo=!self.datePicker.hasDate();self.datePicker.setDate(date);self.datePicker.render();if(goTo===true){self.datePicker.goToDate(date)}},addDate:function(date){var goTo=!self.datePicker.hasDate();self.datePicker.addDate(date);self.datePicker.render();if(goTo===true){self.datePicker.goToDate(date)}},render:function(){self.datePicker.render()},nextMonth:function(){self.datePicker.next(1)},nextMonth:function(skip){self.datePicker.next(skip)},previousMonth:function(){self.datePicker.prev(1)},previousMonth:function(skip){self.datePicker.prev(skip)},onButtonKeyDown:function(that,e){var target=document.activeElement;var pane=$(target).closest(".datepicker__pane");var wrapper=$(pane).closest(".datepicker__wrapper");var isTabPressed=e.key==="Tab"||e.keyCode===9;var isEnterPressed=e.key==="Enter"||e.keyCode===13;var isLeftPressed=e.key==="ArrowLeft"||e.keyCode===37;var isUpPressed=e.key==="ArrowUp"||e.keyCode===38;var isRightPressed=e.key==="ArrowRight"||e.keyCode===39;var isDownPressed=e.key==="ArrowDown"||e.keyCode===40;var isHomePressed=e.key==="Home"||e.keyCode===36;var isEndPressed=e.key==="End"||e.keyCode===35;var isPageUpPressed=e.key==="PageUp"||e.keyCode===33;var isPageDownPressed=e.key=="PageDown"||e.keyCode===34;if(isTabPressed){return}e.preventDefault();e.stopPropagation();if(isHomePressed){if($(target).hasClass("datepicker__daynum")){var row=$(target).closest("tr").index();$(wrapper).find(".datepicker__pane:first-child").find("tbody").find("tr").eq(row).find("td").eq(0).find(".datepicker__daynum").focus()}}if(isEndPressed){if($(target).hasClass("datepicker__daynum")){var row=$(target).closest("tr").index();$(wrapper).find(".datepicker__pane:first-child").find("tbody").find("tr").eq(row).find("td").eq(6).find(".datepicker__daynum").focus()}}if(isPageUpPressed){var row=$(target).closest("tr").index();var column=$(target).closest("td").index();if(e.shiftKey){that.previousMonth(12)}else{that.previousMonth()}$(wrapper).find(".datepicker__pane:first-child").find("tbody").find("tr").eq(row).find("td").eq(column).find(".datepicker__daynum").focus()}if(isPageDownPressed){var row=$(target).closest("tr").index();var column=$(target).closest("td").index();if(e.shiftKey){that.nextMonth(12)}else{that.nextMonth()}$(wrapper).find(".datepicker__pane:first-child").find("tbody").find("tr").eq(row).find("td").eq(column).find(".datepicker__daynum").focus()}if(isRightPressed){if($(target).hasClass("datepicker__daynum")){var index=$(target).data("index");var select=index+1;if($(pane).find(".day__index__"+select+":not(.is-otherMonth, .is-disabled)").length){$(wrapper).find(".datepicker__pane:first-child").find(".day__index__"+select).focus()}else{that.nextMonth();$(wrapper).find(".datepicker__pane:first-child").first().find(".datepicker__daynum:not(.is-otherMonth, .is-disabled)").first().focus()}}if($(target).hasClass("datepicker__prev")){$(wrapper).find(".datepicker__pane:first-child").find(".datepicker__next").focus()}if($(target).hasClass("datepicker__next")){$(wrapper).find(".datepicker__pane:first-child").find(".day__index__0").focus()}}if(isLeftPressed){if($(target).hasClass("datepicker__daynum")){var index=$(target).data("index");var select=index-1;if($(pane).find(".day__index__"+select+":not(.is-otherMonth, .is-disabled)").length){$(wrapper).find(".datepicker__pane:first-child").find(".day__index__"+select).focus()}else{that.previousMonth();$(wrapper).find(".datepicker__pane:first-child").first().find(".datepicker__cal").find("button.datepicker__daynum:not(.is-otherMonth, .is-disabled)").last().focus()}}if($(target).hasClass("datepicker__next")){$(wrapper).find(".datepicker__pane:first-child").find(".datepicker__prev").focus()}if($(target).hasClass("datepicker__prev")){$(wrapper).find(".datepicker__pane:first-child").find(".datepicker__year").focus()}}if(isDownPressed){if($(target).hasClass("datepicker__next")){$(wrapper).find(".datepicker__pane:first-child").find(".day__index__0").focus()}if($(target).hasClass("datepicker__prev")){$(wrapper).find(".datepicker__pane:first-child").find(".day__index__0").focus()}if($(target).hasClass("datepicker__daynum")){var row=$(target).closest("tr").index();var column=$(target).closest("td").index();var numRows=$(pane).find("tbody").find("tr").length;if(row===numRows-1){that.nextMonth();$(".datepicker__pane").first().find(".day__index__0").focus()}else{if($(wrapper).find(".datepicker__pane:first-child").find("tbody").find("tr").eq(row+1).find("td").eq(column).find(".datepicker__daynum:not(.is-otherMonth, .is-disabled)").length){$(wrapper).find(".datepicker__pane:first-child").find("tbody").find("tr").eq(row+1).find("td").eq(column).find(".datepicker__daynum").focus()}else{$(wrapper).find(".datepicker__pane:first-child").find("tbody").find("tr").eq(row+1).find(".datepicker__daynum:not(.is-otherMonth, .is-disabled)").last().focus()}}}}if(isUpPressed){if($(target).hasClass("datepicker__daynum")){var row=$(target).closest("tr").index();var column=$(target).closest("td").index();if(row===0){$(wrapper).find(".datepicker__pane:first-child").find(".datepicker__month").focus()}else{if($(wrapper).find(".datepicker__pane:first-child").find("tbody").find("tr").eq(row-1).find("td").eq(column).find(".datepicker__daynum:not(.is-otherMonth, .is-disabled)").length){$(wrapper).find(".datepicker__pane:first-child").find("tbody").find("tr").eq(row-1).find("td").eq(column).find(".datepicker__daynum").focus()}else{$(wrapper).find(".datepicker__pane:first-child").find("tbody").find("tr").eq(row-1).find(".datepicker__daynum:not(.is-otherMonth, .is-disabled)").first().focus()}}}}if(isEnterPressed){if($(target).hasClass("datepicker__daynum")&&!$(target).hasClass("is-otherMonth")&&!$(target).hasClass("is-disabled")){var dayInt=$(target).data("day");var date=new Date(dayInt);var index=$(target).data("index");if(that.options.ranged){var current=that.datePicker.getDate();if(current.length==1){var range=[];if(date>current[0]){range=that._getDateArray(current[0],date)}else{range=that._getDateArray(date,current[0])}that.setDate(range);that.render()}else{that.setDate(date);that.render()}}else{that.setDate(date);that.render()}$(wrapper).find(".datepicker__pane:first-child").find(".day__index__"+index).focus()}if($(target).hasClass("datepicker__next")){that.nextMonth();$(wrapper).find(".datepicker__pane:first-child").find(".datepicker__next").focus()}if($(target).hasClass("datepicker__prev")){that.previousMonth();$(wrapper).find(".datepicker__pane:first-child").find(".datepicker__prev").focus()}return}},onSelectKeyDown:function(that,e){var target=document.activeElement;var pane=$(target).closest(".datepicker__pane");var wrapper=$(pane).closest(".datepicker__wrapper");var isTabPressed=e.key==="Tab"||e.keyCode===9;var isLeftPressed=e.key==="ArrowLeft"||e.keyCode===37;var isUpPressed=e.key==="ArrowUp"||e.keyCode===38;var isRightPressed=e.key==="ArrowRight"||e.keyCode===39;var isDownPressed=e.key==="ArrowDown"||e.keyCode===40;var isPageUpPressed=e.key==="PageUp"||e.keyCode===33;var isPageDownPressed=e.key=="PageDown"||e.keyCode===34;if(isTabPressed){return}if(isRightPressed||isLeftPressed||isDownPressed||isUpPressed){e.preventDefault()}if(isPageUpPressed){if(e.shiftKey){that.previousMonth(12)}else{that.previousMonth()}if($(target).hasClass("datepicker__month")){$(wrapper).find(".datepicker__pane:first-child").find(".datepicker__month").focus()}if($(target).hasClass("datepicker__year")){$(wrapper).find(".datepicker__pane:first-child").find(".datepicker__year").focus()}}if(isPageDownPressed){if(e.shiftKey){that.nextMonth(12)}else{that.nextMonth()}if($(target).hasClass("datepicker__month")){$(wrapper).find(".datepicker__pane:first-child").find(".datepicker__month").focus()}if($(target).hasClass("datepicker__year")){$(wrapper).find(".datepicker__pane:first-child").find(".datepicker__year").focus()}}if(isRightPressed){if($(target).hasClass("datepicker__month")){$(pane).find(".datepicker__year").focus()}if($(target).hasClass("datepicker__year")){$(pane).find(".datepicker__prev").focus()}}if(isLeftPressed){if($(target).hasClass("datepicker__year")){$(pane).find(".datepicker__month").focus()}}if(isDownPressed){if($(target).hasClass("datepicker__month")){$(pane).find(".day__index__0").focus();$(pane).find(".datepicker__daynum:not(.is-disabled)").first().focus()}if($(target).hasClass("datepicker__year")){$(pane).find(".day__index__0").focus();$(pane).find(".datepicker__daynum:not(.is-disabled)").first().focus()}}},onSelectChange:function(that,e){var target=document.activeElement;var pane=$(target).closest(".datepicker__pane");var wrapper=$(pane).closest(".datepicker__wrapper");var month=$(wrapper).find(".datepicker__month").val();var year=$(wrapper).find(".datepicker__year").val();var date=new Date(year,month,1);that.datePicker.goToDate(date);$(target).focus();if($(target).hasClass("datepicker__month")){$(wrapper).find(".datepicker__pane:first-child").find(".datepicker__month").focus()}if($(target).hasClass("datepicker__year")){$(wrapper).find(".datepicker__pane:first-child").find(".datepicker__year").focus()}},getDisplayDate:function(d){self.i18Nlang;return d?self.i18Nlang.monthsShort[d.getMonth()]+" "+d.getDate():""},getDisplayDateFull:function(d){self.i18Nlang;return d?self.i18Nlang.monthsShort[d.getMonth()]+" "+d.getDate()+", "+d.getFullYear():""},_createPicker:function(){self.options.onRender=self._onRender;var winLang=document.documentElement.lang;var config=JSON.parse($(".date-picker-config").html());if(winLang&&winLang.startsWith("fr")){self.i18Nlang={previousMonth:"",nextMonth:"",months:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],monthsShort:["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],weekdaysLong:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],weekdays:["D","L","M","M","J","V","S"]}}else{self.i18Nlang={previousMonth:"",nextMonth:"",months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","June","July","Aug","Sept","Oct","Nov","Dec"],weekdaysLong:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdays:["S","M","T","W","T","F","S"]}}if(config.twoCharacterWeekDay){if(winLang&&winLang.startsWith("fr")){self.i18Nlang.weekdaysShort=["DI","LU","MA","ME","JE","VE","SA"];self.i18Nlang.weekdays=["DI","LU","MA","ME","JE","VE","SA"]}else{self.i18Nlang.weekdaysShort=["SU","MO","TU","WE","TH","FR","SA"];self.i18Nlang.weekdays=["SU","MO","TU","WE","TH","FR","SA"]}}self.options.i18n=self.i18Nlang;if(!self.options.max){var d=new Date;var year=d.getFullYear();var maxDate=new Date(year+self.options.yearsForward,11,31);self.options.max=maxDate}var multiClass="";if(self.options.display>1){multiClass="multi"}var darkClass="";if(self.options.dark){darkClass="dark"}self.options.templates=self.options.templates={container:['<div class="datepicker__container '+multiClass+" "+darkClass+'">',"<% for (var i = 0; i < "+self.options.display+"; i++) { %> ",'<div class="datepicker__pane">',"<%= renderHeader(i) %>","<%= renderCalendar(i) %>","</div>","<% } %>","</div>"].join("")};var picker=new datePickerJs(self.element,self.options);self.datePicker=picker;var today=new Date;var month=today.getMonth();var year=today.getFullYear();var minMonth=self.options.min.getMonth();var minYear=self.options.min.getFullYear();if(minMonth>month&&minYear>=year){self.nextMonth()}if(config.centeredHeader){$(".datepicker__wrapper").addClass("header-center")}},_onRender:function(){var calendar=$(element).closest(".datepicker");$(calendar).find(".datepicker__daynum.is-selected").attr("aria-selected",true);var selected=$(calendar).find(".datepicker__daynum.is-selected:not(.is-otherMonth)");var count=selected.length;$(calendar).find(".datepicker__daynum.is-today").attr("tabindex","");if(count>1){var selectedDates=this.getDate();var startDate=selectedDates[0];var endDate=selectedDates[selectedDates.length-1];for(var i=0;i<count;i++){var thisDate=new Date;thisDate.setTime($(selected[i]).data("day"));if($(selected[i]).hasClass("is-otherMonth")){continue}if(thisDate.getTime()===startDate.getTime()){$(selected[i]).addClass("is-range-start");$(selected[i]).closest("td").addClass("is-range-start")}else if(thisDate.getTime()==endDate.getTime()){$(selected[i]).addClass("is-range-end");$(selected[i]).closest("td").addClass("is-range-end")}else{$(selected[i]).addClass("is-range-mid");$(selected[i]).closest("td").addClass("is-range-mid")}}}else if(count===1){$(selected[0]).addClass("is-range-none");$(selected[0]).closest("td").addClass("is-range-none")}if(self.options.i18n.weekdaysLong!=null&&self.options.i18n.weekdaysLong.length>0){$(".datepicker__pane").each(function(){$(this).find("th").each(function(index){$(this).attr("abbr",self.options.i18n.weekdaysLong[index])})})}}};return self.init()};return{create:create}});