define(function(require){"use strict";var $=require("jquery"),mustache=require("mustache"),wax=require("mustacheWax");var dom={},template=require("text!/public/Shared/templates/blog/blogs.html"),data=[];var months={0:"January",1:"February",2:"March",3:"April",4:"May",5:"June",6:"July",7:"August",8:"September",9:"October",10:"November",11:"December"};wax(mustache);mustache.Formatters={formatdate:function(str){if(str===""){return""}var dt=new Date(str);var year=dt.getFullYear();var date=dt.getDate();var m=dt.getMonth();return months[m]+" "+date+", "+year}};init();function init(){cacheDom();dom.blogfeed.each(function(){var blogfeed=$(this);initBlogComponent(blogfeed)})}function initBlogComponent(blogfeed){var url=blogfeed.data("blogfeedurl");var ctaText=blogfeed.data("cta-text");var blogarticles=blogfeed.data("blogarticles");var hidedate=blogfeed.data("hidedate")=="True";$.getJSON(url,function(d){data=InitData(d,ctaText,blogarticles,hidedate);if(data.articles.length==3||data.articles.length==1){blogfeed.addClass("odd-layout")}var rendered=mustache.render(template,data);blogfeed.append(rendered)}).fail(function(){if(!blogfeed.parent().hasClass(".page-editor-mode-body")){blogfeed.parent().hide()}})}function InitData(d,ctaText,articlesCounRestriction,hidedate){var articlesCount=d.items.length>articlesCounRestriction?articlesCounRestriction:d.items.length;var queryString=window.location.search;var urlParams=new URLSearchParams(queryString);var debugArticlesCount=urlParams.get("articlescount");if(debugArticlesCount!=null){articlesCount=parseInt(debugArticlesCount,10)}var dataObj={articles:d.items.slice(0,articlesCount),ctatext:ctaText};if(hidedate){dataObj.articles.forEach(function(article){article.date_published=""})}return dataObj}function cacheDom(){dom.root=$(".blog");dom.blogfeed=$(".blogfeed")}});